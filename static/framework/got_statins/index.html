<!DOCTYPE html>
<html>
  <head>
    <title>Got Statins?</title>
  </head>
  <body>

  <h1 style="font-family: Arial, sans-serif;">Got Statins?</h1>
  <a id="TheAnswer" style="font-weight: bold; font-size: 120pt; font-family: Arial, sans-serif; text-decoration: none; color: black;">
  	... 
  </a> 
	<script  src='../smart/scripts/smart-api-client.js'></script>
	<script>
	  
SMART.ready(function(){

  SMART.MANIFEST_get("pedi_bpc@apps.smartplatforms.org", function(p) {
    var m = p.json;
    SMART.call_app(m, {a: 1, b: 2, c: 3}, function(result) {
      console.log("Returned from call:" );
      console.log(result);
    });
  });

        SMART.MEDS_get(function(meds) {
	
	var statin = meds.graph
                    .where("?m rdf:type sp:Medication")
                    .where("?m sp:drugName ?dn")
                    .where("?dn dcterms:title ?drugname");	
	var answer = false;
	
	for (var i = 0; i < statin.length; i++) {
	 console.log(statin[i].drugname.value);
	       if (is_a_statin(statin[i].drugname.value))
		   answer = true;
          }

	  document.getElementById("TheAnswer").innerHTML = answer ? "Yes." : "No.";

	});
		
   var is_a_statin = function(drug) {
      if (drug.match(/statin/i)) return true;
      if (drug.match(/Advicor/i)) return true;
      if (drug.match(/Altoprev/i)) return true;
      if (drug.match(/Caduet/i)) return true;
      if (drug.match(/Crestor/i)) return true;
      if (drug.match(/Lescol/i)) return true;
      if (drug.match(/Lipitor/i)) return true;
      if (drug.match(/Mevacor/i)) return true;
      if (drug.match(/Pravachol/i)) return true;
      if (drug.match(/Simcor/i)) return true;
      if (drug.match(/Vytorin/i)) return true;
      if (drug.match(/Zocor/i)) return true;

      return false;
   }
});		
	</script>
  </body>
</html>
