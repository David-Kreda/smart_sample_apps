<!DOCTYPE html>
<html>
  <head>
    <title>Got Statins?</title>
    <style>
      body { font-family: "Helvetica Neue", Helvetica, Calibri, Verdana, sans-serif; }
      #the_answer { font-weight: bold; font-size: 120pt; }
    </style>
  </head>
  <body>
    <h1>Got Statins?</h1>
    <div id="the_answer">...</div>

    <script src='../smart/scripts/smart-api-client.js'></script>
    <script src='../smart/scripts/smart-jsonld-context.js'></script>
    <script src='jsonld/js/jsonld.js'></script>
    <script src='rdfparser.js'></script>

    <script>
      var answer = false;
      SMART.ready(function(){
        SMART.MEDS_get().then(function(r) {
          var meds = r.objects.of_type.Medication
          for (var i in meds) {
            if (is_a_statin(meds[i].drugName.dcterms__title)) { answer = true; }
          }
          document.getElementById("the_answer").innerHTML = answer ? "Yes." : "No.";
        })
      });

      var is_a_statin = function(drug) {
          if (drug.match(/statin/i))    return true;
          if (drug.match(/Advicor/i))   return true;
          if (drug.match(/Altoprev/i))  return true;
          if (drug.match(/Caduet/i))    return true;
          if (drug.match(/Crestor/i))   return true;
          if (drug.match(/Lescol/i))    return true;
          if (drug.match(/Lipitor/i))   return true;
          if (drug.match(/Mevacor/i))   return true;
          if (drug.match(/Pravachol/i)) return true;
          if (drug.match(/Simcor/i))    return true;
          if (drug.match(/Vytorin/i))   return true;
          if (drug.match(/Zocor/i))     return true;

          return false;
      }
    </script>
    </body>
</html>
