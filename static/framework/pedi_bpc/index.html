<!DOCTYPE html>
<!-- 
/**
*  Blood Pressure Centiles SMART Application
*
*  Developed by: Nikolai Schwertner
*  Revision history:
*       2011-06-06 Code refactoring
*       2011-06-02 Modified the table template to output the method and the month/year format
*       2011-05-26 Added JCM's calculator code
*/
-->
<html lang="en">
    <head>
        <meta http-equiv="Content-Type" content="text/html; charset=utf-8">
        <title>Blood Pressure Centiles SMART Application</title>
        <link rel="stylesheet" href="css/bpc-screen.css" type="text/css" media="screen">
        <link type="text/css" href="css/themes/custom/jquery.ui.all.css" rel="stylesheet" />
        <script src="js/smart/smart-api-page.js"></script>
        <script src="js/lib/raphael.js"></script>
        <script src="js/lib/jquery.js"></script>
        <script src="js/lib/jquery-jtemplates.js"></script>
        <script src="js/lib/jquery-ui-1.8.13.custom.min.js"></script>
        <script src="js/lib/date.js"></script>
        <script src="js/cdc_height_tables.js"></script>
        <script src="js/nih_bp_tables.js"></script>
        <script src="js/util.js"></script>
        <script src="js/popup.js"></script>
        <script src="js/bpc-config.js"></script>
        <script src="js/bpc-data.js"></script>
        <script src="js/bpc-filters.js"></script>
        <script src="js/bpc-ui.js"></script>
        <script src="js/bpc-graph.js"></script>
        <script>
            // Initiate the data retrieval, processing, and chart drawing
            $.when(get_demographics(), get_vitals()).then( function (patient, vitals) {
                initApp ( processData(patient, vitals) ); 
            });
        </script>
    </head>
    <body>
        <div id="main">
        
            <!-- Page header -->
            <div id="headings">
                <table width="786">
                <tr><td align="left" valign="center"><div id="title">Blood Pressure Centiles SMART Application</div></td>
                <td align="right">
                <div id="logo"><a href="http://www.smartplatforms.org/" target="_blank"><img src="images/smart-logo.png" border="0" width="65" height="40" alt="SMART Logo" /></a></div>
                </td></tr></table>
            </div>
            <div id="error" ><img style="border-color:#A00;border-width:3px;" src="images/ajax-loader.gif" alt="Loading"/></div>
            
            <!-- Tabs -->
            <div id="tabs">
            
                <ul>
                    <li><a href="#tab_short">Short Term View</a></li>
                    <li><a href="#tab_long">Long Term View</a></li>
                    <li><a href="#tab_table">Table View</a></li>
                    <li><a href="#tab_calculator">Calculator</a></li>
                </ul>
                
                <div id="tab_short">
                    <div id="holder_short"></div>
					
					<style>
	.toggler { width: 400px; height: 310px; padding-top: 20px; padding-bottom: 20px;}
	#buttonShow { padding: .5em 1em; text-decoration: none; }
	#buttonHide { padding: .5em 1em; text-decoration: none; }
	#effect { width: 350px;  height: 300px; padding: 0.4em; position: relative; }
	#effect h3 { margin: 0; padding: 0.4em; text-align: center; }
	</style>
	<script>
	$(function() {
		// run the currently selected effect
		function showHelp() {
			// get effect type from 
			var selectedEffect = $( "#effectTypes" ).val();

			// most effect types need no options passed by default
			var options = {};

			// run the effect
			$( "#effect" ).show( selectedEffect, options, 1000 );
		};
		
		// run the currently selected effect
		function hideHelp() {
			// get effect type from 
			var selectedEffect = $( "#effectTypes" ).val();

			// most effect types need no options passed by default
			var options = {};

			// run the effect
			$( "#effect" ).hide( selectedEffect, options, 1000 );
		};

		// set effect from select menu value
		$( "#buttonHide" ).click(function() {
			hideHelp();
			return false;
		});
		
		$( "#buttonShow" ).click(function() {
			showHelp();
			return false;
		});

		$( "#effect" ).hide();
	});
	</script>



<div id="help_short">

<div class="toggler">
	<div id="effect">
		<h3>Help: Short term view</h3>
		<p>
			Lorem ipsum dolor sit amet, consectetur adipiscing elit. Nulla ac ipsum nec mi tincidunt aliquet. Quisque vehicula arcu sed felis euismod consequat. Nulla enim mi, porttitor quis porttitor eget, euismod sed lorem. Proin consequat pharetra dui, eu pretium risus ultrices sed. Curabitur ligula tellus, vehicula vel luctus quis, vehicula eget elit. Aliquam vitae elit nibh, in dapibus nunc. Suspendisse potenti. Donec molestie ipsum non dolor consectetur quis venenatis odio sollicitudin. Donec elementum, neque lobortis dapibus sodales, est purus adipiscing turpis, eu viverra eros augue vel quam. Aliquam in augue id neque pulvinar consequat tincidunt ac justo. Vivamus mollis fringilla magna, at volutpat libero euismod nec. Pellentesque habitant morbi tristique senectus et netus et malesuada fames ac turpis egestas. Donec libero lacus, facilisis ut condimentum at, pretium eget libero. Sed et augue sed turpis vehicula accumsan. Nulla volutpat sollicitudin augue, vitae malesuada nisl molestie vel. Ut augue nulla, accumsan nec congue dignissim, laoreet et orci.  
		</p>
		<p>&nbsp;</p>
		<p align="center"><a href="#" id="buttonHide" class="ui-state-default ui-corner-all">OK</a></p>
	</div>
</div>

<select name="effects" id="effectTypes">
	<option value="blind">Blind</option>
	<option value="clip">Clip</option>
	<option value="drop">Drop</option>
	<option value="slide" selected>Slide</option>
</select>

<!--<input type="hidden" name="effects" id="effectTypes" value="slide"/>-->

<!--<a href="#" id="buttonShow" class="ui-state-default ui-corner-all">Help</a>-->


</div>
<div class="clearall">&nbsp;</div>
					
                </div>
                
                <div id="tab_long">
                    <div id="wrapper_long" class="tab_wrapper">
                        <div id="filters">
                            <div id="filter_encounter" class="toggle-set">
                                <input type="checkbox" id="chkFilterInpatient" onClick="updateFilters()" />
                                <label for="chkFilterInpatient"> Inpatient </label>
                                <input type="checkbox" id="chkFilterAmbulatory" onClick="updateFilters()" checked/>
                                <label for="chkFilterAmbulatory"> Ambulatory </label>
                            </div>
                            <div id="filter_site" class="toggle-set">
                                <input type="checkbox" id="chkFilterArm" onClick="updateFilters()" checked/>
                                <label for="chkFilterArm"> Arm </label>
                                <input type="checkbox" id="chkFilterLeg"  onClick="updateFilters()" />
                                <label for="chkFilterLeg"> Leg </label>
                            </div>
                            <div id="filter_position" class="toggle-set">
                                <input type="checkbox" id="chkFilterSitting" onClick="updateFilters()" checked/>
                                <label for="chkFilterSitting"> Sitting </label>
                                <input type="checkbox" id="chkFilterStanding"  onClick="updateFilters()" />
                                <label for="chkFilterStanding"> Standing </label>
                            </div>
                            <div id="filter_method" class="toggle-set">
                                <input type="checkbox" id="chkFilterAuscultation" onClick="updateFilters()" checked/>
                                <label for="chkFilterAuscultation"> Auscultation </label>
                                <input type="checkbox" id="chkFilterMachine"  onClick="updateFilters()" />
                                <label for="chkFilterMachine"> Machine </label>
                            </div>
                            <div id="filter_timerange">
                                <div id="label-timerange"></div>
                                <div id="slider-timerange"></div>
                            </div>
                        </div>
                        <div id="holder_long"></div>
                    </div>
                </div> <!-- long term tab -->
                
                <div id="tab_table">
                    <div id="wrapper_table" class="tab_wrapper">
                        <div id="holder_table"></div>
                    </div>
                </div>
                
                <div id="tab_calculator">
					<div id="result-label">
					</div>
                    <div id="calculator_main">
					
                        <div id='result-percentiles'>
                          <table>
                            <tr><th>Systolic</th><th></th><th>Diastolic</th></tr>
                            <tr>
                              <td><span class="spct"></span>%</td>
                              <td><span class="slash">/</span></td>
                              <td><span class="dpct"></span>%</td>
                            </tr>
                          </table>
                        </div>

                        <br clear="both"/>

                        <form id="input" method="GET" action="#" data-ajax="false">

                          <table>
                            <tr>
                                <td class="inputLabel"><label for="add_systolic">BP</label></td>
                                <td><input type="number" name="add_systolic2" id="add_systolic" value="0" min="0" max="200" size="2"  /> /</td>
								<td><input type="number" name="add_diastolic" id="add_diastolic" value="0" min="0" max="200" size="2" /> mmHg</td>
                            </tr>
                            <tr>
                                <td class="inputLabel"><label for="add_age">Age</label></td>
                                <td><input type="number" name="name" id="add_age" value="0" min="0" max="18" size="2" autofocus/> y</td>
								<td><input type="number" name="name" id="add_age_months" value="0" min="0" max="11" size="2" /> m</td>
							</tr>
                            <tr>
                                <td class="inputLabel"><label for="add_height">Height</label></td>
                                <td colspan=2><input type="number" name="add_height" id="add_height" value="0" min="0" max="200" size="2" /> cm</td>
                            </tr>
                          </table>
                         
                          <div id="gender_select" data-role="fieldcontain"> 
                            <fieldset data-role="controlgroup" data-type="horizontal"> 
                              <legend>Gender</legend> 
                              <input type="radio" name="add_gender" id="add_male" value="male" checked="checked" /> 
                              <label for="add_male">Male</label> 

                              <input type="radio" name="add_gender" id="add_female" value="female" /> 
                              <label for="add_female">Female</label> 
                            </fieldset> 
                          </div> 

                        </form>
                    </div>
                    <div id="calculator_thresholds">
                        <div id='result-thresholds'>
                          <table>
                            <tr><th>Thresholds</th></tr>
                            <tr>
                              <td><span id="calculator_thresholds_out"></span></td>
                            </tr>
                          </table>
                        </div>
                    </div>
                    <div class="clearall">&nbsp;</div>
                </div> <!-- calculator tab -->
                
            </div> <!-- tabs -->

            <p id="copy">v0.6</p>
        </div>
        
        <!-- jTemplates template for the table view -->
        <div style="display:none"><textarea id="template" rows="0" cols="0"><!--
            {#template MAIN}
                <p class="tablelabel">{$T}</p>
                <table class="nicetable">
					<thead>
						{#include HEAD}
					</thead>
					<tbody>
						{#foreach $T.data as record}
							{#include ROW root=$T.record}
						{#/for}
					</tbody>
                </table>
            {#/template MAIN}
            
            {#template HEAD}
                <tr>
                    <th>Date</th>
                    <th>Age</th>
                    <th>Height</th>
                    <th>Blood Pressure</th>
                    <th>Percentiles</th>
                    <th>Site</th>
                    <th>Position</th>
                    <th>Method</th>
                    <th>Encounter</th>
                </tr>
            {#/template HEAD}
            
            {#template ROW}
                <tr>
                    <td>{$T.date}</td>
                    <td>{getYears($T.age)}y {getMonths($T.age)}m</td>
                    <td>{#if $T.height}{$T.height} cm{#else}-{#/if}</td>
                    <td>{$T.systolic}/{$T.diastolic} mmHg</td>
                    <td>{#if $T.sPercentile && $T.dPercentile}{$T.sPercentile}%/{$T.dPercentile}%{#else}-{#/if}</td>
                    <td>{$T.site}</td>
                    <td>{$T.position}</td>
                    <td>{$T.method}</td>
                    <td>{$T.encounter}</td>
                </tr>
            {#/template ROW}
        --></textarea></div>
    </body>
</html>
