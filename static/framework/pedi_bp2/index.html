<!DOCTYPE html>
<!-- 
/**
*  Blood Pressure Centiles SMART Application
*
*  Developed by: Nikolai Schwertner
*  Revision history:
*       2011-05-19 Cleaned up the HTML code
*/
-->
<html lang="en">
    <head>
        <meta http-equiv="Content-Type" content="text/html; charset=utf-8">
        <title>Blood Pressure Centiles SMART Application</title>
        <link rel="stylesheet" href="css/bpc-screen.css" type="text/css" media="screen">
        <link type="text/css" href="css/themes/custom/jquery.ui.all.css" rel="stylesheet" />
        <script src="js/smart/smart-api-page.js"></script>
        <script src="js/lib/raphael.js"></script>
		<script src="js/lib/jquery.js"></script>
        <script src="js/lib/jquery-jtemplates.js"></script>
        <script src="js/lib/jquery-ui-1.8.12.custom.min.js"></script>
        <script src="js/lib/date.js"></script>
        <script src="js/cdc_height_tables.js"></script>
        <script src="js/nih_bp_tables.js"></script>
        <script src="js/util.js"></script>
        <script src="js/popup.js"></script>
        <script src="js/bpc-config.js"></script>
        <script src="js/bpc-data.js"></script>
        <script src="js/bpc-filters.js"></script>
        <script src="js/bpc-ui.js"></script>
        <script src="js/bpc-graph.js"></script>
        <script>
            // Initiate the data retrieval, processing, and chart drawing
            $.when(get_demographics(), get_vitals()).then( function (patient, vitals) {
                initApp ( processData(patient, vitals) ); 
            });
        </script>
    </head>
    <body>

        <div id="main">
            <div id="error" >Loading patient data. Please wait...</div>
            <div id="header"></div>
            <div id="tabs">
                <ul>
                    <li><a href="#tab_short">Short Term View</a></li>
                    <li><a href="#tab_long">Long Term View</a></li>
                    <li><a href="#tab_table">Table View</a></li>
                </ul>
                <div id="tab_short">
                    <div id="holder_short"></div>
                </div>
                <div id="tab_long">
                    <div id="wrapper_long">
                        <div id="filters_long">
                            <div id="encounter_long">
                                <input type="checkbox" id="chkLongInpatient" onClick="updateFiltersLong()" checked/>
                                <label for="chkLongInpatient"> Inpatient </label>
                                <input type="checkbox" id="chkLongAmbulatory" onClick="updateFiltersLong()" checked/>
                                <label for="chkLongAmbulatory"> Ambulatory </label>
                            </div>
                            <div id="site_long">
                                <input type="checkbox" id="chkLongArm" onClick="updateFiltersLong()" checked/>
                                <label for="chkLongArm"> Arm </label>
                                <input type="checkbox" id="chkLongLeg"  onClick="updateFiltersLong()" checked/>
                                <label for="chkLongLeg"> Leg </label>
                            </div>
                            <div id="position_long">
                                <input type="checkbox" id="chkLongSitting" onClick="updateFiltersLong()" checked/>
                                <label for="chkLongSitting"> Sitting </label>
                                <input type="checkbox" id="chkLongStanding"  onClick="updateFiltersLong()" checked/>
                                <label for="chkLongStanding"> Standing </label>
                            </div>
                            <div id="slider-long">
                                <div id="label-range-long"></div>
                                <div id="slider-range-long"></div>
                            </div>
                        </div>
                        <div id="holder_long"></div>
                    </div>
                </div>
                <div id="tab_table">
                    <div id="wrapper_table">
                        <div id="filters_table">
                            <div id="encounter_table">
                                <input type="checkbox" id="chkTableInpatient" onClick="updateFiltersTable()" checked/>
                                <label for="chkTableInpatient"> Inpatient </label>
                                <input type="checkbox" id="chkTableAmbulatory" onClick="updateFiltersTable()" />
                                <label for="chkTableAmbulatory"> Ambulatory </label>
                            </div>
                            <div id="site_table">
                                <input type="checkbox" id="chkTableArm" onClick="updateFiltersTable()" />
                                <label for="chkTableArm"> Arm </label>
                                <input type="checkbox" id="chkTableLeg"  onClick="updateFiltersTable()" checked/>
                                <label for="chkTableLeg"> Leg </label>
                            </div>
                            <div id="position_table">
                                <input type="checkbox" id="chkTableSitting" onClick="updateFiltersTable()" checked/>
                                <label for="chkTableSitting"> Sitting </label>
                                <input type="checkbox" id="chkTableStanding"  onClick="updateFiltersTable()" />
                                <label for="chkTableStanding"> Standing </label>
                            </div>
                            <div id="slider-long">
                                <div id="label-range-table"></div>
                                <div id="slider-range-table"></div>
                            </div>
                        </div>               
                        <div id="holder_table"></div>
                    </div>
                </div>
            </div>

            <p id="copy">BPC SMART Application - v0.4</p>
        </div>
        
        <!-- jTemplates template for the table view -->
        <div style="display:none"><textarea id="template" rows="0" cols="0"><!--
            {#template MAIN}
                <p class="tablelabel">{$T}</p>
                <table class="nicetable">
                    {#include HEAD}
                    {#foreach $T.data as record}
                        {#include ROW root=$T.record}
                    {#/for}
                </table>
            {#/template MAIN}
            
            {#template HEAD}
                <tr>
                    <th>Date</th>
                    <th>Age</th>
                    <th>Height</th>
                    <th>Blood Pressure</th>
                    <th>Percentiles</th>
                    <th>Site</th>
                    <th>Postition</th>
                    <th>Encounter</th>
                </tr>
            {#/template HEAD}
            
            {#template ROW}
                <tr>
                    <td>{$T.date}</td>
                    <td>{$T.age} year-old</td>
                    <td>{$T.height} cm</td>
                    <td>{$T.systolic}/{$T.diastolic} mmHg</td>
                    <td>{$T.sPercentile}%/{$T.dPercentile}%</td>
                    <td>{$T.site}</td>
                    <td>{$T.position}</td>
                    <td>{$T.encounter}</td>
                </tr>
            {#/template ROW}
        --></textarea></div>
    </body>
</html>
